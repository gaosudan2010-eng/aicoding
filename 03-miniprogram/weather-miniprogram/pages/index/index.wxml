<!--pages/index/index.wxml-->
<view class="page {{bgClass}}">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-wrap">
      <input 
        class="search-input" 
        placeholder="æœç´¢åŸå¸‚ï¼Œå¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·" 
        value="{{searchText}}"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
      />
      <view class="search-btn" bindtap="onSearch">ğŸ”</view>
    </view>
    <view class="location-btn" bindtap="onGetLocation">ğŸ“</view>
  </view>

  <!-- æœç´¢ç»“æœåˆ—è¡¨ -->
  <view class="search-results" wx:if="{{searchResults.length > 0}}">
    <view 
      class="search-result-item" 
      wx:for="{{searchResults}}" 
      wx:key="id"
      bindtap="onSelectCity"
      data-city="{{item}}"
    >
      <text class="city-name">{{item.name}}</text>
      <text class="city-country">{{item.admin1 || ''}} {{item.country}}</text>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-icon">â³</view>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- å¤©æ°”å†…å®¹ -->
  <view class="weather-content" wx:if="{{weatherData && !loading}}">
    <!-- å½“å‰å¤©æ°”å¡ç‰‡ -->
    <view class="current-weather card">
      <view class="city-info">
        <text class="city-name">{{currentCity.name}}</text>
        <text class="update-time">æ›´æ–°äº {{updateTime}}</text>
      </view>
      
      <view class="weather-main">
        <view class="weather-icon">{{weatherInfo.icon}}</view>
        <view class="temperature">{{currentTemp}}Â°</view>
      </view>
      
      <view class="weather-desc">{{weatherInfo.desc}}</view>
      
      <view class="weather-details">
        <view class="detail-item">
          <text class="detail-label">ä½“æ„Ÿ</text>
          <text class="detail-value">{{feelsLike}}Â°</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">æ¹¿åº¦</text>
          <text class="detail-value">{{humidity}}%</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">é£é€Ÿ</text>
          <text class="detail-value">{{windSpeed}} km/h</text>
        </view>
      </view>
    </view>

    <!-- 7å¤©é¢„æŠ¥ -->
    <view class="forecast card">
      <view class="card-title">7å¤©é¢„æŠ¥</view>
      <view class="forecast-list">
        <view class="forecast-item" wx:for="{{forecast}}" wx:key="date">
          <text class="forecast-date">{{item.dateStr}}</text>
          <text class="forecast-icon">{{item.icon}}</text>
          <view class="forecast-temp">
            <text class="temp-high">{{item.maxTemp}}Â°</text>
            <text class="temp-low">{{item.minTemp}}Â°</text>
          </view>
          <text class="forecast-rain" wx:if="{{item.rainChance > 0}}">ğŸ’§{{item.rainChance}}%</text>
        </view>
      </view>
    </view>

    <!-- æ¸©åº¦å•ä½åˆ‡æ¢ -->
    <view class="unit-toggle">
      <view 
        class="unit-btn {{tempUnit === 'celsius' ? 'active' : ''}}" 
        bindtap="onToggleUnit"
        data-unit="celsius"
      >Â°C</view>
      <view 
        class="unit-btn {{tempUnit === 'fahrenheit' ? 'active' : ''}}" 
        bindtap="onToggleUnit"
        data-unit="fahrenheit"
      >Â°F</view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!weatherData && !loading}}">
    <view class="empty-icon">ğŸŒ¤ï¸</view>
    <text class="empty-text">æœç´¢åŸå¸‚æˆ–ç‚¹å‡»å®šä½æŸ¥çœ‹å¤©æ°”</text>
  </view>
</view>

