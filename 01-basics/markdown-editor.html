<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>// MARKDOWN.exe - Geek Editor</title>
    <style>
        /* ==================== åŸºç¡€æ ·å¼é‡ç½® ==================== */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            /* æå®¢ç»ˆç«¯é…è‰² - æš—é»‘ä¸»é¢˜ */
            --bg-primary: #0a0e14;
            --bg-secondary: #0d1117;
            --bg-tertiary: #161b22;
            --bg-card: #1c2128;
            --border: #30363d;
            --border-active: #58a6ff;
            
            /* éœ“è™¹è‰²å½© */
            --neon-green: #39ff14;
            --neon-cyan: #00ffff;
            --neon-pink: #ff006e;
            --neon-purple: #bc13fe;
            --neon-yellow: #ffff00;
            --neon-orange: #ff6600;
            
            /* æ–‡å­—é¢œè‰² */
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            
            /* ä»£ç é«˜äº® */
            --code-keyword: #ff7b72;
            --code-string: #a5d6ff;
            --code-comment: #8b949e;
            --code-function: #d2a8ff;
            --code-number: #79c0ff;
            
            /* å­—ä½“ */
            --font-mono: 'JetBrains Mono', 'Fira Code', 'SF Mono', Consolas, monospace;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        /* äº®è‰²ä¸»é¢˜ */
        body.light-theme {
            --bg-primary: #ffffff;
            --bg-secondary: #f6f8fa;
            --bg-tertiary: #eaeef2;
            --bg-card: #ffffff;
            --border: #d0d7de;
            --border-active: #0969da;
            --text-primary: #1f2328;
            --text-secondary: #656d76;
            --text-muted: #8c959f;
            --neon-green: #1a7f37;
            --neon-cyan: #0969da;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ==================== æ‰«æçº¿æ•ˆæœ ==================== */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 255, 255, 0.03) 0px,
                rgba(0, 255, 255, 0.03) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
            opacity: 0.5;
        }

        body.light-theme::before {
            opacity: 0;
        }

        /* ==================== é¡¶éƒ¨å¯¼èˆªæ  ==================== */
        .navbar {
            height: 48px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            position: relative;
            z-index: 100;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .navbar-logo {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--neon-green);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-logo::before {
            content: '>';
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .navbar-status {
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--neon-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 5px var(--neon-green); }
            50% { opacity: 0.5; box-shadow: 0 0 15px var(--neon-green); }
        }

        .navbar-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 0.4rem 0.8rem;
            font-family: var(--font-mono);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .nav-btn:hover {
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
        }

        .nav-btn.primary {
            background: var(--neon-green);
            border-color: var(--neon-green);
            color: var(--bg-primary);
        }

        .nav-btn.primary:hover {
            box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);
        }

        /* ==================== å·¥å…·æ  ==================== */
        .toolbar {
            height: 40px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 1rem;
            gap: 0.25rem;
        }

        .tool-btn {
            width: 32px;
            height: 32px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
            position: relative;
        }

        .tool-btn:hover {
            background: var(--bg-card);
            color: var(--neon-cyan);
        }

        .tool-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 0.3rem 0.6rem;
            font-size: 0.7rem;
            font-family: var(--font-mono);
            border: 1px solid var(--border);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
            z-index: 50;
        }

        .tool-btn:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .tool-divider {
            width: 1px;
            height: 20px;
            background: var(--border);
            margin: 0 0.5rem;
        }

        .toolbar-right {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .word-count {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        /* ==================== ä¸»ç¼–è¾‘åŒºåŸŸ ==================== */
        .main-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .editor-pane, .preview-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .pane-header {
            height: 36px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 1rem;
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .pane-header .icon {
            margin-right: 0.5rem;
        }

        .pane-header .filename {
            color: var(--neon-cyan);
        }

        .editor-pane {
            border-right: 1px solid var(--border);
        }

        /* ç¼–è¾‘å™¨ */
        .editor-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .line-numbers {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 50px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 1rem 0;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--text-muted);
            text-align: right;
            user-select: none;
            overflow: hidden;
        }

        .line-number {
            padding-right: 1rem;
            height: 1.6rem;
            line-height: 1.6rem;
        }

        .line-number.active {
            color: var(--neon-cyan);
            background: rgba(0, 255, 255, 0.05);
        }

        #editor {
            position: absolute;
            left: 50px;
            top: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            border: none;
            outline: none;
            resize: none;
            padding: 1rem;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.6rem;
            color: var(--text-primary);
            tab-size: 4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        #editor::placeholder {
            color: var(--text-muted);
        }

        #editor::-webkit-scrollbar {
            width: 10px;
        }

        #editor::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        #editor::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        #editor::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* é¢„è§ˆåŒºåŸŸ */
        .preview-wrapper {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem 2rem;
            background: var(--bg-primary);
        }

        .preview-wrapper::-webkit-scrollbar {
            width: 10px;
        }

        .preview-wrapper::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .preview-wrapper::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        /* ==================== Markdowné¢„è§ˆæ ·å¼ ==================== */
        .preview-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .preview-content h1 {
            font-size: 2rem;
            font-weight: 600;
            color: var(--neon-cyan);
            border-bottom: 2px solid var(--border);
            padding-bottom: 0.5rem;
            margin: 1.5rem 0 1rem;
        }

        .preview-content h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--neon-green);
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.3rem;
            margin: 1.5rem 0 0.8rem;
        }

        .preview-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--neon-purple);
            margin: 1.2rem 0 0.6rem;
        }

        .preview-content h4, .preview-content h5, .preview-content h6 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 1rem 0 0.5rem;
        }

        .preview-content p {
            margin: 0.8rem 0;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .preview-content a {
            color: var(--neon-cyan);
            text-decoration: none;
            border-bottom: 1px dashed var(--neon-cyan);
        }

        .preview-content a:hover {
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        .preview-content strong {
            color: var(--neon-pink);
            font-weight: 600;
        }

        .preview-content em {
            color: var(--neon-yellow);
            font-style: italic;
        }

        .preview-content code {
            font-family: var(--font-mono);
            background: var(--bg-tertiary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85em;
            color: var(--neon-orange);
            border: 1px solid var(--border);
        }

        .preview-content pre {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-left: 3px solid var(--neon-green);
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            position: relative;
        }

        .preview-content pre::before {
            content: attr(data-lang);
            position: absolute;
            top: 0;
            right: 0;
            background: var(--neon-green);
            color: var(--bg-primary);
            padding: 0.2rem 0.6rem;
            font-size: 0.7rem;
            font-family: var(--font-mono);
            border-radius: 0 6px 0 6px;
        }

        .preview-content pre code {
            background: none;
            padding: 0;
            border: none;
            color: var(--text-primary);
            font-size: 0.85rem;
            line-height: 1.6;
        }

        .preview-content blockquote {
            border-left: 4px solid var(--neon-purple);
            background: rgba(188, 19, 254, 0.1);
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        .preview-content ul, .preview-content ol {
            margin: 0.8rem 0;
            padding-left: 2rem;
            color: var(--text-secondary);
        }

        .preview-content li {
            margin: 0.4rem 0;
            line-height: 1.6;
        }

        .preview-content li::marker {
            color: var(--neon-cyan);
        }

        .preview-content hr {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--neon-cyan), transparent);
            margin: 2rem 0;
        }

        .preview-content img {
            max-width: 100%;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .preview-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .preview-content th, .preview-content td {
            border: 1px solid var(--border);
            padding: 0.6rem 1rem;
            text-align: left;
        }

        .preview-content th {
            background: var(--bg-tertiary);
            color: var(--neon-cyan);
            font-weight: 600;
        }

        .preview-content tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        /* ä»»åŠ¡åˆ—è¡¨ */
        .preview-content .task-list-item {
            list-style: none;
            margin-left: -1.5rem;
        }

        .preview-content .task-list-item input {
            margin-right: 0.5rem;
            accent-color: var(--neon-green);
        }

        /* ==================== çŠ¶æ€æ  ==================== */
        .statusbar {
            height: 24px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            font-family: var(--font-mono);
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .statusbar-left, .statusbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .statusbar-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .statusbar-item.clickable {
            cursor: pointer;
        }

        .statusbar-item.clickable:hover {
            color: var(--neon-cyan);
        }

        /* ==================== å¿«æ·é”®æç¤ºé¢æ¿ ==================== */
        .shortcuts-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            z-index: 200;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            min-width: 400px;
        }

        .shortcuts-panel.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .shortcuts-panel h3 {
            font-family: var(--font-mono);
            color: var(--neon-cyan);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .shortcut-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            border-bottom: 1px solid var(--border);
        }

        .shortcut-item:last-child {
            border-bottom: none;
        }

        .shortcut-keys {
            display: flex;
            gap: 0.3rem;
        }

        .shortcut-key {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--neon-green);
        }

        .shortcut-desc {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .panel-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 199;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .panel-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* ==================== Toastæç¤º ==================== */
        .toast {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%) translateY(50px);
            background: var(--bg-card);
            color: var(--neon-green);
            padding: 0.8rem 1.5rem;
            border: 1px solid var(--neon-green);
            font-family: var(--font-mono);
            font-size: 0.85rem;
            z-index: 300;
            opacity: 0;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(57, 255, 20, 0.2);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* ==================== å“åº”å¼ ==================== */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            .editor-pane {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
            .navbar-status { display: none; }
            .toolbar { overflow-x: auto; }
            .shortcuts-panel { min-width: 90%; }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="hello.html" class="nav-btn" style="margin-right: 0.5rem;">â† ESC</a>
            <span class="navbar-logo">MARKDOWN.exe</span>
        </div>
        
        <div class="navbar-status">
            <span class="status-dot"></span>
            <span id="saveStatus">å·²ä¿å­˜</span>
        </div>
        
        <div class="navbar-actions">
            <button class="nav-btn" onclick="toggleTheme()" data-tooltip="åˆ‡æ¢ä¸»é¢˜">
                <span id="themeIcon">ğŸŒ™</span>
            </button>
            <button class="nav-btn" onclick="showShortcuts()">
                âŒ¨ï¸ å¿«æ·é”®
            </button>
            <button class="nav-btn" onclick="exportMarkdown()">
                ğŸ“„ å¯¼å‡ºMD
            </button>
            <button class="nav-btn primary" onclick="exportHTML()">
                ğŸŒ å¯¼å‡ºHTML
            </button>
        </div>
    </nav>

    <!-- å·¥å…·æ  -->
    <div class="toolbar">
        <button class="tool-btn" onclick="insertFormat('**', '**')" data-tooltip="ç²—ä½“ Ctrl+B">ğ</button>
        <button class="tool-btn" onclick="insertFormat('*', '*')" data-tooltip="æ–œä½“ Ctrl+I">ğ¼</button>
        <button class="tool-btn" onclick="insertFormat('~~', '~~')" data-tooltip="åˆ é™¤çº¿">SÌ¶</button>
        <button class="tool-btn" onclick="insertFormat('`', '`')" data-tooltip="è¡Œå†…ä»£ç ">&lt;/&gt;</button>
        
        <div class="tool-divider"></div>
        
        <button class="tool-btn" onclick="insertLine('# ')" data-tooltip="æ ‡é¢˜1">H1</button>
        <button class="tool-btn" onclick="insertLine('## ')" data-tooltip="æ ‡é¢˜2">H2</button>
        <button class="tool-btn" onclick="insertLine('### ')" data-tooltip="æ ‡é¢˜3">H3</button>
        
        <div class="tool-divider"></div>
        
        <button class="tool-btn" onclick="insertLine('- ')" data-tooltip="æ— åºåˆ—è¡¨">â€¢</button>
        <button class="tool-btn" onclick="insertLine('1. ')" data-tooltip="æœ‰åºåˆ—è¡¨">1.</button>
        <button class="tool-btn" onclick="insertLine('- [ ] ')" data-tooltip="ä»»åŠ¡åˆ—è¡¨">â˜</button>
        <button class="tool-btn" onclick="insertLine('> ')" data-tooltip="å¼•ç”¨">â</button>
        
        <div class="tool-divider"></div>
        
        <button class="tool-btn" onclick="insertCodeBlock()" data-tooltip="ä»£ç å—">{}</button>
        <button class="tool-btn" onclick="insertLine('---\n')" data-tooltip="åˆ†å‰²çº¿">â€”</button>
        <button class="tool-btn" onclick="insertLink()" data-tooltip="é“¾æ¥">ğŸ”—</button>
        <button class="tool-btn" onclick="insertImage()" data-tooltip="å›¾ç‰‡">ğŸ–¼ï¸</button>
        <button class="tool-btn" onclick="insertTable()" data-tooltip="è¡¨æ ¼">â–¦</button>
        
        <div class="toolbar-right">
            <span class="word-count">
                <span id="charCount">0</span> å­—ç¬¦ | <span id="wordCount">0</span> è¯ | <span id="lineCount">0</span> è¡Œ
            </span>
        </div>
    </div>

    <!-- ä¸»ç¼–è¾‘åŒºåŸŸ -->
    <div class="main-container">
        <!-- ç¼–è¾‘å™¨é¢æ¿ -->
        <div class="editor-pane">
            <div class="pane-header">
                <span class="icon">ğŸ“</span>
                <span>ç¼–è¾‘å™¨</span>
                <span style="margin-left: 0.5rem; color: var(--text-muted);">|</span>
                <span class="filename" style="margin-left: 0.5rem;">untitled.md</span>
            </div>
            <div class="editor-wrapper">
                <div class="line-numbers" id="lineNumbers"></div>
                <textarea id="editor" placeholder="// å¼€å§‹ç¼–å†™ä½ çš„ Markdown...

# æ¬¢è¿ä½¿ç”¨ MARKDOWN.exe

è¿™æ˜¯ä¸€ä¸ªæå®¢é£æ ¼çš„ Markdown ç¼–è¾‘å™¨ã€‚

## å¿«é€Ÿå¼€å§‹

- åœ¨å·¦ä¾§è¾“å…¥ Markdown
- å³ä¾§å®æ—¶é¢„è§ˆæ•ˆæœ
- ä½¿ç”¨å·¥å…·æ å¿«é€Ÿæ’å…¥æ ¼å¼

## å¿«æ·é”®

- `Ctrl + B` ç²—ä½“
- `Ctrl + I` æ–œä½“
- `Ctrl + S` ä¿å­˜
- `Ctrl + /` å¿«æ·é”®å¸®åŠ©

Happy Coding! ğŸš€"></textarea>
            </div>
        </div>

        <!-- é¢„è§ˆé¢æ¿ -->
        <div class="preview-pane">
            <div class="pane-header">
                <span class="icon">ğŸ‘ï¸</span>
                <span>é¢„è§ˆ</span>
                <span style="margin-left: 0.5rem; color: var(--text-muted);">|</span>
                <span style="margin-left: 0.5rem; color: var(--neon-green);">LIVE</span>
            </div>
            <div class="preview-wrapper">
                <div class="preview-content" id="preview"></div>
            </div>
        </div>
    </div>

    <!-- çŠ¶æ€æ  -->
    <div class="statusbar">
        <div class="statusbar-left">
            <span class="statusbar-item">
                <span>ğŸ“</span>
                <span>è¡Œ <span id="cursorLine">1</span>, åˆ— <span id="cursorCol">1</span></span>
            </span>
            <span class="statusbar-item">
                <span>ğŸ“„</span>
                <span>Markdown</span>
            </span>
            <span class="statusbar-item">
                <span>ğŸ”¤</span>
                <span>UTF-8</span>
            </span>
        </div>
        <div class="statusbar-right">
            <span class="statusbar-item clickable" onclick="toggleTheme()">
                <span id="themeName">ğŸŒ™ Dark Mode</span>
            </span>
            <span class="statusbar-item">
                <span>âš¡</span>
                <span>Ready</span>
            </span>
        </div>
    </div>

    <!-- å¿«æ·é”®é¢æ¿ -->
    <div class="panel-overlay" id="panelOverlay" onclick="hideShortcuts()"></div>
    <div class="shortcuts-panel" id="shortcutsPanel">
        <h3>âŒ¨ï¸ å¿«æ·é”®åˆ—è¡¨</h3>
        <div class="shortcut-item">
            <span class="shortcut-desc">ç²—ä½“</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">B</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">æ–œä½“</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">I</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">ä¿å­˜</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">S</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">æ’¤é”€</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">Z</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">é‡åš</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">Y</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">å¿«æ·é”®å¸®åŠ©</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">/</span>
            </div>
        </div>
        <div class="shortcut-item">
            <span class="shortcut-desc">åˆ‡æ¢ä¸»é¢˜</span>
            <div class="shortcut-keys">
                <span class="shortcut-key">Ctrl</span>
                <span class="shortcut-key">Shift</span>
                <span class="shortcut-key">L</span>
            </div>
        </div>
    </div>

    <!-- Toastæç¤º -->
    <div class="toast" id="toast"></div>

    <script>
        /* ==================== DOMå…ƒç´  ==================== */
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const lineNumbers = document.getElementById('lineNumbers');

        /* ==================== çŠ¶æ€å˜é‡ ==================== */
        let isDarkTheme = true;
        let saveTimeout = null;

        /* ==================== åˆå§‹åŒ– ==================== */
        function init() {
            loadFromStorage();
            updatePreview();
            updateLineNumbers();
            updateWordCount();
            setupEventListeners();
        }

        /* ==================== äº‹ä»¶ç›‘å¬ ==================== */
        function setupEventListeners() {
            // ç¼–è¾‘å™¨è¾“å…¥
            editor.addEventListener('input', () => {
                updatePreview();
                updateLineNumbers();
                updateWordCount();
                autoSave();
            });

            // æ»šåŠ¨åŒæ­¥
            editor.addEventListener('scroll', () => {
                lineNumbers.scrollTop = editor.scrollTop;
            });

            // å…‰æ ‡ä½ç½®
            editor.addEventListener('click', updateCursorPosition);
            editor.addEventListener('keyup', updateCursorPosition);

            // Tabé”®æ”¯æŒ
            editor.addEventListener('keydown', handleTab);

            // å¿«æ·é”®
            document.addEventListener('keydown', handleShortcuts);
        }

        /* ==================== Markdownè§£æ ==================== */
        function parseMarkdown(text) {
            let html = text;

            // è½¬ä¹‰HTML
            html = html.replace(/&/g, '&amp;')
                       .replace(/</g, '&lt;')
                       .replace(/>/g, '&gt;');

            // ä»£ç å—ï¼ˆéœ€è¦å…ˆå¤„ç†ï¼‰
            html = html.replace(/```(\w*)\n([\s\S]*?)```/g, (match, lang, code) => {
                return `<pre data-lang="${lang || 'code'}"><code>${code.trim()}</code></pre>`;
            });

            // è¡Œå†…ä»£ç 
            html = html.replace(/`([^`]+)`/g, '<code>$1</code>');

            // æ ‡é¢˜
            html = html.replace(/^###### (.+)$/gm, '<h6>$1</h6>');
            html = html.replace(/^##### (.+)$/gm, '<h5>$1</h5>');
            html = html.replace(/^#### (.+)$/gm, '<h4>$1</h4>');
            html = html.replace(/^### (.+)$/gm, '<h3>$1</h3>');
            html = html.replace(/^## (.+)$/gm, '<h2>$1</h2>');
            html = html.replace(/^# (.+)$/gm, '<h1>$1</h1>');

            // ç²—ä½“å’Œæ–œä½“
            html = html.replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>');
            html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');
            html = html.replace(/~~(.+?)~~/g, '<del>$1</del>');

            // é“¾æ¥å’Œå›¾ç‰‡
            html = html.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1">');
            html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');

            // å¼•ç”¨
            html = html.replace(/^&gt; (.+)$/gm, '<blockquote>$1</blockquote>');
            // åˆå¹¶è¿ç»­å¼•ç”¨
            html = html.replace(/<\/blockquote>\n<blockquote>/g, '\n');

            // ä»»åŠ¡åˆ—è¡¨
            html = html.replace(/^- \[x\] (.+)$/gm, '<li class="task-list-item"><input type="checkbox" checked disabled> $1</li>');
            html = html.replace(/^- \[ \] (.+)$/gm, '<li class="task-list-item"><input type="checkbox" disabled> $1</li>');

            // æ— åºåˆ—è¡¨
            html = html.replace(/^- (.+)$/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>\n?)+/g, '<ul>$&</ul>');

            // æœ‰åºåˆ—è¡¨
            html = html.replace(/^\d+\. (.+)$/gm, '<li>$1</li>');

            // åˆ†å‰²çº¿
            html = html.replace(/^---$/gm, '<hr>');
            html = html.replace(/^\*\*\*$/gm, '<hr>');

            // è¡¨æ ¼
            html = html.replace(/^\|(.+)\|$/gm, (match, content) => {
                const cells = content.split('|').map(c => c.trim());
                if (cells.every(c => /^-+$/.test(c))) {
                    return ''; // åˆ†éš”è¡Œ
                }
                const isHeader = html.indexOf(match) < html.indexOf('|---|');
                const tag = isHeader ? 'th' : 'td';
                return '<tr>' + cells.map(c => `<${tag}>${c}</${tag}>`).join('') + '</tr>';
            });
            html = html.replace(/(<tr>.*<\/tr>\n?)+/g, '<table>$&</table>');

            // æ®µè½
            html = html.replace(/^(?!<[a-z]|$)(.+)$/gm, '<p>$1</p>');

            // æ¸…ç†å¤šä½™ç©ºè¡Œ
            html = html.replace(/<p><\/p>/g, '');
            html = html.replace(/\n{3,}/g, '\n\n');

            return html;
        }

        /* ==================== æ›´æ–°é¢„è§ˆ ==================== */
        function updatePreview() {
            const markdown = editor.value;
            preview.innerHTML = parseMarkdown(markdown);
        }

        /* ==================== è¡Œå· ==================== */
        function updateLineNumbers() {
            const lines = editor.value.split('\n');
            const currentLine = editor.value.substring(0, editor.selectionStart).split('\n').length;
            
            let html = '';
            for (let i = 1; i <= lines.length; i++) {
                html += `<div class="line-number ${i === currentLine ? 'active' : ''}">${i}</div>`;
            }
            lineNumbers.innerHTML = html;
        }

        /* ==================== å­—æ•°ç»Ÿè®¡ ==================== */
        function updateWordCount() {
            const text = editor.value;
            document.getElementById('charCount').textContent = text.length;
            document.getElementById('wordCount').textContent = text.trim() ? text.trim().split(/\s+/).length : 0;
            document.getElementById('lineCount').textContent = text.split('\n').length;
        }

        /* ==================== å…‰æ ‡ä½ç½® ==================== */
        function updateCursorPosition() {
            const text = editor.value.substring(0, editor.selectionStart);
            const lines = text.split('\n');
            document.getElementById('cursorLine').textContent = lines.length;
            document.getElementById('cursorCol').textContent = lines[lines.length - 1].length + 1;
            updateLineNumbers();
        }

        /* ==================== å·¥å…·æ åŠŸèƒ½ ==================== */
        
        // æ’å…¥æ ¼å¼ï¼ˆåŒ…è£¹é€‰ä¸­æ–‡æœ¬ï¼‰
        function insertFormat(before, after) {
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            const text = editor.value;
            const selected = text.substring(start, end) || 'æ–‡æœ¬';
            
            editor.value = text.substring(0, start) + before + selected + after + text.substring(end);
            editor.selectionStart = start + before.length;
            editor.selectionEnd = start + before.length + selected.length;
            editor.focus();
            
            updatePreview();
            updateLineNumbers();
            autoSave();
        }

        // æ’å…¥è¡Œé¦–æ ¼å¼
        function insertLine(prefix) {
            const start = editor.selectionStart;
            const text = editor.value;
            
            // æ‰¾åˆ°å½“å‰è¡Œçš„å¼€å§‹ä½ç½®
            const lineStart = text.lastIndexOf('\n', start - 1) + 1;
            
            editor.value = text.substring(0, lineStart) + prefix + text.substring(lineStart);
            editor.selectionStart = editor.selectionEnd = lineStart + prefix.length;
            editor.focus();
            
            updatePreview();
            updateLineNumbers();
            autoSave();
        }

        // æ’å…¥ä»£ç å—
        function insertCodeBlock() {
            const start = editor.selectionStart;
            const text = editor.value;
            const selected = text.substring(start, editor.selectionEnd) || 'code';
            const codeBlock = '\n```javascript\n' + selected + '\n```\n';
            
            editor.value = text.substring(0, start) + codeBlock + text.substring(editor.selectionEnd);
            editor.selectionStart = start + 15;
            editor.selectionEnd = start + 15 + selected.length;
            editor.focus();
            
            updatePreview();
            updateLineNumbers();
            autoSave();
        }

        // æ’å…¥é“¾æ¥
        function insertLink() {
            const url = prompt('è¯·è¾“å…¥é“¾æ¥åœ°å€ï¼š', 'https://');
            if (url) {
                const start = editor.selectionStart;
                const text = editor.value;
                const selected = text.substring(start, editor.selectionEnd) || 'é“¾æ¥æ–‡å­—';
                const link = `[${selected}](${url})`;
                
                editor.value = text.substring(0, start) + link + text.substring(editor.selectionEnd);
                editor.focus();
                
                updatePreview();
                autoSave();
            }
        }

        // æ’å…¥å›¾ç‰‡
        function insertImage() {
            const url = prompt('è¯·è¾“å…¥å›¾ç‰‡åœ°å€ï¼š', 'https://');
            if (url) {
                const start = editor.selectionStart;
                const text = editor.value;
                const alt = text.substring(start, editor.selectionEnd) || 'å›¾ç‰‡æè¿°';
                const img = `![${alt}](${url})`;
                
                editor.value = text.substring(0, start) + img + text.substring(editor.selectionEnd);
                editor.focus();
                
                updatePreview();
                autoSave();
            }
        }

        // æ’å…¥è¡¨æ ¼
        function insertTable() {
            const start = editor.selectionStart;
            const text = editor.value;
            const table = '\n| æ ‡é¢˜1 | æ ‡é¢˜2 | æ ‡é¢˜3 |\n|-------|-------|-------|\n| å†…å®¹1 | å†…å®¹2 | å†…å®¹3 |\n| å†…å®¹4 | å†…å®¹5 | å†…å®¹6 |\n';
            
            editor.value = text.substring(0, start) + table + text.substring(editor.selectionEnd);
            editor.focus();
            
            updatePreview();
            updateLineNumbers();
            autoSave();
        }

        /* ==================== Tabé”®å¤„ç† ==================== */
        function handleTab(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = editor.selectionStart;
                const text = editor.value;
                
                editor.value = text.substring(0, start) + '    ' + text.substring(editor.selectionEnd);
                editor.selectionStart = editor.selectionEnd = start + 4;
                
                updatePreview();
                updateLineNumbers();
            }
        }

        /* ==================== å¿«æ·é”®å¤„ç† ==================== */
        function handleShortcuts(e) {
            // Ctrl + B: ç²—ä½“
            if (e.ctrlKey && e.key === 'b') {
                e.preventDefault();
                insertFormat('**', '**');
            }
            // Ctrl + I: æ–œä½“
            if (e.ctrlKey && e.key === 'i') {
                e.preventDefault();
                insertFormat('*', '*');
            }
            // Ctrl + S: ä¿å­˜
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveToStorage();
                showToast('ğŸ’¾ å·²ä¿å­˜åˆ°æœ¬åœ°');
            }
            // Ctrl + /: æ˜¾ç¤ºå¿«æ·é”®
            if (e.ctrlKey && e.key === '/') {
                e.preventDefault();
                showShortcuts();
            }
            // Ctrl + Shift + L: åˆ‡æ¢ä¸»é¢˜
            if (e.ctrlKey && e.shiftKey && e.key === 'L') {
                e.preventDefault();
                toggleTheme();
            }
            // Esc: å…³é—­é¢æ¿
            if (e.key === 'Escape') {
                hideShortcuts();
            }
        }

        /* ==================== ä¸»é¢˜åˆ‡æ¢ ==================== */
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            document.body.classList.toggle('light-theme', !isDarkTheme);
            document.getElementById('themeIcon').textContent = isDarkTheme ? 'ğŸŒ™' : 'â˜€ï¸';
            document.getElementById('themeName').textContent = isDarkTheme ? 'ğŸŒ™ Dark Mode' : 'â˜€ï¸ Light Mode';
            saveToStorage();
        }

        /* ==================== å¯¼å‡ºåŠŸèƒ½ ==================== */
        function exportMarkdown() {
            const content = editor.value;
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'document.md';
            a.click();
            URL.revokeObjectURL(url);
            showToast('ğŸ“„ Markdown å·²å¯¼å‡º');
        }

        function exportHTML() {
            const previewHTML = preview.innerHTML;
            const fullHTML = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Export</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; line-height: 1.6; color: #333; }
        h1, h2, h3 { color: #1a1a1a; margin-top: 1.5rem; }
        h1 { border-bottom: 2px solid #eee; padding-bottom: 0.5rem; }
        h2 { border-bottom: 1px solid #eee; padding-bottom: 0.3rem; }
        code { background: #f5f5f5; padding: 0.2rem 0.4rem; border-radius: 4px; font-family: monospace; }
        pre { background: #f5f5f5; padding: 1rem; border-radius: 8px; overflow-x: auto; }
        pre code { background: none; padding: 0; }
        blockquote { border-left: 4px solid #ddd; padding-left: 1rem; color: #666; margin: 1rem 0; }
        a { color: #0066cc; }
        img { max-width: 100%; }
        table { border-collapse: collapse; width: 100%; margin: 1rem 0; }
        th, td { border: 1px solid #ddd; padding: 0.5rem; text-align: left; }
        th { background: #f5f5f5; }
    </style>
</head>
<body>
${previewHTML}
</body>
</html>`;
            
            const blob = new Blob([fullHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'document.html';
            a.click();
            URL.revokeObjectURL(url);
            showToast('ğŸŒ HTML å·²å¯¼å‡º');
        }

        /* ==================== å¿«æ·é”®é¢æ¿ ==================== */
        function showShortcuts() {
            document.getElementById('shortcutsPanel').classList.add('show');
            document.getElementById('panelOverlay').classList.add('show');
        }

        function hideShortcuts() {
            document.getElementById('shortcutsPanel').classList.remove('show');
            document.getElementById('panelOverlay').classList.remove('show');
        }

        /* ==================== æœ¬åœ°å­˜å‚¨ ==================== */
        function autoSave() {
            document.getElementById('saveStatus').textContent = 'ä¿å­˜ä¸­...';
            
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                saveToStorage();
                document.getElementById('saveStatus').textContent = 'å·²ä¿å­˜';
            }, 1000);
        }

        function saveToStorage() {
            localStorage.setItem('markdownEditorData', JSON.stringify({
                content: editor.value,
                isDarkTheme: isDarkTheme
            }));
        }

        function loadFromStorage() {
            const saved = localStorage.getItem('markdownEditorData');
            if (saved) {
                const data = JSON.parse(saved);
                if (data.content) {
                    editor.value = data.content;
                }
                if (data.isDarkTheme !== undefined) {
                    isDarkTheme = data.isDarkTheme;
                    document.body.classList.toggle('light-theme', !isDarkTheme);
                    document.getElementById('themeIcon').textContent = isDarkTheme ? 'ğŸŒ™' : 'â˜€ï¸';
                    document.getElementById('themeName').textContent = isDarkTheme ? 'ğŸŒ™ Dark Mode' : 'â˜€ï¸ Light Mode';
                }
            }
        }

        /* ==================== Toastæç¤º ==================== */
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // åˆå§‹åŒ–
        init();
    </script>
</body>
</html>

